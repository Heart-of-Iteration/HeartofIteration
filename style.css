/* ===== Base layout ===== */
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  overflow: hidden;
}

main {
  min-height: 100%;
  display: grid;
  place-items: center;
  text-align: center;
  padding: 2rem;
}

/* ===== Top-left pixel/fractal title ===== */
:root {
  --title-x: 42px;
  --title-y: 42px;
}

.pixel-title {
  position: fixed !important;
  top: calc(env(safe-area-inset-top, 0px) + var(--title-y));
  left: calc(env(safe-area-inset-left, 0px) + var(--title-x));
  margin: 0;
  z-index: 1200;

  font-family: "Press Start 2P", "Courier New", monospace;
  font-size: clamp(18px, 5vmin, 42px);
  letter-spacing: 2px;
  text-transform: uppercase;

  color: #0b0b0b;
  background: rgba(255, 255, 255, 0.72);
  border-radius: 8px;
  padding: 8px 10px;

  text-shadow:
    0 1px 0 #9ff, 1px 0 0 #9ff, -1px 0 0 #9ff, 0 -1px 0 #9ff,
    2px 2px 0 rgba(0,170,170,0.9),
    4px 3px 0 rgba(0,140,160,0.75),
    6px 5px 0 rgba(0,110,150,0.6),
    8px 7px 0 rgba(0,90,140,0.45),
    10px 9px 0 rgba(0,70,120,0.35);
  user-select: none;
}

@media (prefers-color-scheme: dark) {
  .pixel-title {
    color: #fff;
    background: rgba(30,30,30,0.78);
    text-shadow:
      0 1px 0 #5ff, 1px 0 0 #5ff, -1px 0 0 #5ff, 0 -1px 0 #5ff,
      2px 2px 0 rgba(50,220,255,0.9),
      4px 3px 0 rgba(40,180,240,0.75),
      6px 5px 0 rgba(30,140,220,0.6),
      8px 7px 0 rgba(25,110,200,0.45),
      10px 9px 0 rgba(20,90,180,0.35);
  }
}

@media (prefers-contrast: more) {
  .pixel-title {
    background: #fff;
    color: #000;
    text-shadow:
      0 0 0 #000, 0 0 0 #000, 0 0 0 #000, 0 0 0 #000,
      2px 2px 0 #000, 4px 4px 0 #000, 6px 6px 0 #000;
  }
}

@media (max-width: 480px) {
  :root { --title-x: 10px; --title-y: 10px; }
  .pixel-title { padding: 6px 8px; letter-spacing: 1px; }
}

/* ===== Flying bird (always on top) ===== */
#flying-bird {
  position: fixed;
  z-index: 2000;         /* above everything */
  pointer-events: auto;
  top: 24px;             /* visible default */
  left: 72px;            /* visible default */
  width: 80px;
  height: 80px;
  cursor: pointer;
  transition: transform 0.3s ease;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
}
#flying-bird svg { pointer-events: none; }
#flying-bird:hover {
  filter: drop-shadow(0 6px 12px rgba(0,0,0,0.3));
}

.game-title {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  font-weight: 600;
  font-size: 1.2rem;
  color: #333;
  background: rgba(255, 255, 255, 0.9);
  padding: 0.5rem 1rem;
  border-radius: 8px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: 1500;
}
#flying-bird:hover + .game-title,
.game-title:hover { opacity: 1; }

/* ===== Background canvas (sky + ground) ===== */
#bg-canvas {
  position: fixed;
  inset: 0;
  z-index: 400;          /* ABOVE the tree visuals, BELOW UI */
  pointer-events: none;  /* never blocks clicks */
}

/* ===== Central Tree (visual SVG behind ground) ===== */
#central-tree {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 200;          /* BELOW ground (bg-canvas) */
  pointer-events: none;
}

/* SVG size; keep in sync with #tree-ui */
#tree-svg {
  width: 1000px;
  height: 650px;
  display: block;
  filter: drop-shadow(0 8px 24px rgba(0,0,0,0.3));
  pointer-events: none;
}

/* ===== Tree UI overlay (hitbox + dropdown) ABOVE ground ===== */
#tree-ui {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 1000px;   /* match #tree-svg */
  height: 650px;
  z-index: 800;    /* ABOVE ground, BELOW bird/title */
  pointer-events: none; /* only children receive events */
}

/* Base-square trigger aligned over the first square */
.games-trigger {
  position: absolute;
  background: transparent;
  transition: all 0.3s ease;
  border-radius: 4px;
  cursor: pointer;
  z-index: 801;
  pointer-events: auto;
}

/* Dropdown anchored to the trigger */
.games-dropdown {
  position: absolute;
  top: calc(100% + 10px);
  left: 50%;
  transform: translateX(-50%) scale(0.95);
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  min-width: 280px;
  pointer-events: auto;
  z-index: 802;
}

/* Show dropdown on hover (desktop) or when toggled (mobile/keyboard) */
.games-trigger.is-hover .games-dropdown,
.games-trigger.open .games-dropdown {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) scale(1);
}

/* Dropdown aesthetics */
.dropdown-content {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 1rem;
  box-shadow: 0 12px 40px rgba(0,0,0,0.2);
  border: 1px solid rgba(255,255,255,0.3);
}

.game-option {
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  text-decoration: none;
  color: #333;
  border-radius: 12px;
  transition: all 0.2s ease;
  margin-bottom: 0.5rem;
}
.game-option:last-child { margin-bottom: 0; }
.game-option:hover { background: rgba(74, 144, 226, 0.1); transform: translateX(4px); }

.game-icon { font-size: 1.5rem; margin-right: 1rem; width: 40px; text-align: center; }
.game-info { display: flex; flex-direction: column; text-align: left; }
.game-info strong { font-size: 1rem; margin-bottom: 0.2rem; }
.game-info small  { color: #666; font-size: 0.85rem; }

/* ===== Accessibility ===== */
.games-trigger:focus,
.game-option:focus,
#flying-bird:focus {
  outline: 2px solid #0b5fff;
  outline-offset: 4px;
  border-radius: 8px;
}

@media (prefers-reduced-motion: reduce) {
  #flying-bird,
  .games-trigger,
  .games-dropdown,
  .game-option { transition: none; }
}

@media (prefers-contrast: high) {
  .dropdown-content { background: #fff; border: 2px solid #000; }
  .game-option:hover { background: #e0e0e0; }
  .game-info small { color: #000; }
}

@media (prefers-color-scheme: dark) {
  .dropdown-content {
    background: rgba(30, 30, 30, 0.95);
    border: 1px solid rgba(255,255,255,0.2);
  }
  .game-option { color: #fff; }
  .game-info small { color: #ccc; }
  .game-option:hover { background: rgba(74, 144, 226, 0.2); }
  .game-title { background: rgba(30, 30, 30, 0.9); color: #fff; }
}

/* ===== Responsive: keep #tree-svg and #tree-ui sizes in sync ===== */
@media (max-width: 1024px) {
  #tree-svg, #tree-ui { width: 700px; height: 500px; }
}

@media (max-width: 768px) {
  #tree-svg, #tree-ui { width: 300px; height: 400px; }

  .games-trigger {
    width: 80px !important;
    height: 80px !important;
    left: calc(50% - 40px) !important;
    top: calc(100% - 80px) !important;
  }

  .games-dropdown { min-width: 250px; top: calc(100% + 5px); }

  .dropdown-content { padding: 0.75rem; }
  .game-option { padding: 0.5rem 0.75rem; }
  .game-icon { font-size: 1.25rem; margin-right: 0.75rem; width: 35px; }
  .game-info strong { font-size: 0.9rem; }
  .game-info small { font-size: 0.8rem; }
}

@media (max-width: 480px) {
  #tree-svg, #tree-ui { width: 250px; height: 350px; }

  .games-trigger {
    width: 70px !important;
    height: 70px !important;
    left: calc(50% - 35px) !important;
    top: calc(100% - 70px) !important;
  }

  .games-dropdown { min-width: 220px; }
  .game-option { padding: 0.4rem 0.6rem; }
  .game-icon { font-size: 1.1rem; margin-right: 0.6rem; width: 30px; }
}

/* ===== Print ===== */
@media print {
  #flying-bird,
  #central-tree,
  #tree-ui,
  .games-dropdown { display: none; }
}
